{% extends "layouts/base.html" %}

{% block title %} UI Tables {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
    <style>
        .form-control {
            margin-bottom: 10px;
        }
    </style>
{% endblock stylesheets %}

{% block content %}

<div class="row">
    <!-- KÅ«riniai Table -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header card-header-info">
                <h4 class="card-title">KÅ«riniÅ³ sÄ…raÅ¡as</h4>
            </div>
            <div class="card-body">
                <table class="table" id="kuriniai-table">
                    <thead>
                    <tr>
                        <th class="text-center">#</th>
                        <th>Pavadinimas</th>
                        <th>Tipas</th>
                        <th>TrukmÄ—</th>
                        <th>Video</th>
                        <th class="text-right">Actions</th>
                    </tr>
                    </thead>
                    <tbody id="table-body">
                        <tr>
                            <td class="text-center">1</td>
                            <td>DzÅ«kÅ³ daina</td>
                            <td>Daina</td>
                            <td>3:45</td>
                            <td><a href="https://www.youtube.com/watch?v=EXAMPLE1" target="_blank" class="btn btn-primary btn-sm">Watch ðŸŽµ</a></td>
                            <td class="td-actions text-right">
                                <button type="button" class="btn btn-success">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button type="button" class="btn btn-danger" onclick="deleteRow(this)">
                                    <i class="material-icons">close</i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Form to Add a New KÅ«rinys -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header card-header-danger">
                <h4 class="card-title">PridÄ—ti naujÄ… kÅ«rinÄ¯</h4>
                <p class="category">Ä®veskite informacijÄ… apie kÅ«rinÄ¯</p>
            </div>
            <div class="card-body">
                <form id="add-form">
                    <div class="form-group">
                        <label>Pavadinimas</label>
                        <input type="text" id="pavadinimas" class="form-control" required placeholder="KÅ«rinio pavadinimas">
                    </div>

                    <div class="form-group">
                        <label>Tipas</label>
                        <select id="tipas" class="form-control" required>
                            <option value="Å okis">Å okis</option>
                            <option value="Kapela">Kapela</option>
                            <option value="Daina">Daina</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>TrukmÄ—</label>
                        <input type="text" id="trukme" class="form-control" required placeholder="00:00">
                    </div>

                    <div class="form-group">
                        <label>YouTube URL</label>
                        <input type="url" id="youtube-url" class="form-control" placeholder="https://www.youtube.com/watch?v=EXAMPLE">
                    </div>

                    <button type="button" class="btn btn-danger" onclick="addKurinys()">PridÄ—ti kÅ«rinÄ¯</button>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
    <script>
        function addKurinys() {
            let table = document.getElementById("table-body");
            let rowCount = table.rows.length + 1;

            let pavadinimas = document.getElementById("pavadinimas").value;
            let tipas = document.getElementById("tipas").value;
            let trukme = document.getElementById("trukme").value;
            let youtubeUrl = document.getElementById("youtube-url").value.trim();

            if (pavadinimas.trim() === "" || trukme.trim() === "") {
                alert("PraÅ¡ome uÅ¾pildyti visus laukelius!");
                return;
            }

            // Validate YouTube URL (optional)
            let youtubeLink = "";
            if (youtubeUrl !== "") {
                let youtubeRegex = /^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_-]{11})/;
                if (!youtubeRegex.test(youtubeUrl)) {
                    alert("Ä®veskite teisingÄ… YouTube nuorodÄ…!");
                    return;
                }
                youtubeLink = `<a href="${youtubeUrl}" target="_blank" class="btn btn-primary btn-sm">Watch ðŸŽµ</a>`;
            } else {
                youtubeLink = "â€”"; // Show dash if no link provided
            }

            let row = `<tr>
                            <td class="text-center">${rowCount}</td>
                            <td>${pavadinimas}</td>
                            <td>${tipas}</td>
                            <td>${trukme}</td>
                            <td>${youtubeLink}</td>
                            <td class="td-actions text-right">
                                <button type="button" class="btn btn-success">
                                    <i class="material-icons">edit</i>
                                </button>
                                <button type="button" class="btn btn-danger" onclick="deleteRow(this)">
                                    <i class="material-icons">close</i>
                                </button>
                            </td>
                        </tr>`;

            table.innerHTML += row;

            // Clear input fields after adding
            document.getElementById("pavadinimas").value = "";
            document.getElementById("trukme").value = "";
            document.getElementById("youtube-url").value = "";
        }

        function deleteRow(btn) {
            let row = btn.closest("tr");
            row.remove();
        }
    </script>
{% endblock javascripts %}
